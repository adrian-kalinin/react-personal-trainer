import{j as s,F as h,A as T,a as t,C as E,T as F,B as f,b as P,c as p,d as y,e as j,f as A,g as B,D,h as x,i as b,k as S,l as I,m as O,n as u}from"./@mui-04b1f69c.js";import{r as d,a as L}from"./react-d615ca6f.js";import{c as q}from"./react-dom-fd27bb5c.js";import{B as R}from"./react-router-dom-00f7061b.js";import{u as W,O as $,a as M,b as m}from"./react-router-a5762c05.js";import{d as N}from"./dayjs-c34536bb.js";import"./react-is-de691395.js";import"./@babel-791e448d.js";import"./clsx-1229b3e0.js";import"./prop-types-67732e07.js";import"./reselect-36a88051.js";import"./@emotion-e8bcd9a7.js";import"./hoist-non-react-statics-ce857b4d.js";import"./stylis-581c9ed0.js";import"./react-transition-group-f04caf2b.js";import"./@popperjs-d2c33dca.js";import"./scheduler-a07ebc82.js";import"./@remix-run-207ff6b5.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerpolicy&&(i.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?i.credentials="include":a.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();function Y(){const e=W();return s(h,{children:[s(T,{position:"static",children:[t(E,{}),s(F,{children:[t(f,{color:"inherit",onClick:()=>e("/customers"),children:"Customers"}),t(f,{color:"inherit",onClick:()=>e("/trainings"),children:"Trainings"})]})]}),t(P,{children:t($,{})})]})}function w(e){const[r,n]=d.exports.useState(!1);function o(){n(!0)}function a(){n(!1)}function i(){e.onDelete(),n(!1)}return s(h,{children:[s(p,{sx:{position:"fixed",top:"auto",bottom:20,left:"50%",transform:"translateX(-50%)"},children:[e.selected&&e.editable&&t(y,{color:"secondary",children:t(j,{})}),t(y,{sx:{mx:2},color:"primary",onClick:()=>e.setIsCreateDialogOpen(!0),children:t(A,{})}),e.selected&&t(y,{color:"error",onClick:o,children:t(B,{})})]}),s(D,{open:r,onClose:a,children:[t(x,{id:"alert-dialog-title",children:"Confirm the action"}),t(b,{children:t(S,{id:"alert-dialog-description",children:"Do you really want to delete the data?"})}),s(I,{children:[t(f,{onClick:a,color:"primary",variant:"contained",children:"Cancel"}),t(f,{onClick:i,color:"error",variant:"contained",autoFocus:!0,children:"Confirm"})]})]})]})}function _(e){return Number(e.split("/").pop())}function k(e,r){return e.filter(o=>o.rel===r)[0].href}function g(e,r){if(e){const n=k(e,r);return _(n)}return 0}async function H(e){const n=await(await fetch(e)).json();return{...n,id:g(n==null?void 0:n.links,"self")}}async function G(){const n=(await(await fetch("https://customerrest.herokuapp.com/api/customers")).json()).content.map(o=>({...o,id:g(o==null?void 0:o.links,"self")}));return Promise.all(n)}async function J(){const n=(await(await fetch("https://customerrest.herokuapp.com/api/trainings")).json()).content.map(async o=>({...o,id:g(o.links,"self"),date:N(o.date),customer:await H(k(o.links,"customer"))}));return Promise.all(n)}async function K(e){const n=await(await fetch("https://customerrest.herokuapp.com/api/customers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstname:e.firstname,lastname:e.lastname,email:e.email,phone:e.phone,streetaddress:e.streetaddress,postcode:e.postcode,city:e.city})})).json();return{...n,id:g(n==null?void 0:n.links,"self")}}async function X(e){await fetch(`https://customerrest.herokuapp.com/api/customers/${e.id}`,{method:"DELETE"})}async function z(e){await fetch(`https://customerrest.herokuapp.com/api/trainings/${e.id}`,{method:"DELETE"})}const Q=[{field:"firstname",headerName:"First Name",flex:1},{field:"lastname",headerName:"Last Name",flex:1},{field:"streetaddress",headerName:"Street Address",flex:1},{field:"postcode",headerName:" Post Code",flex:1},{field:"city",headerName:"City",flex:1},{field:"email",headerName:"Email",flex:1},{field:"phone",headerName:"Phone",flex:1}],U=[{field:"date",headerName:"Date",flex:1,valueFormatter:e=>N(e==null?void 0:e.value).format("DD/MM/YYYY hh:mm A")},{field:"duration",headerName:"Duration",flex:1,valueFormatter:e=>`${e==null?void 0:e.value} min`},{field:"activity",headerName:"Activity",flex:1},{field:"customer",headerName:"Customer",flex:1,valueFormatter:e=>`${e==null?void 0:e.value.firstname} ${e==null?void 0:e.value.lastname}`}];function V(){const[e,r]=d.exports.useState([]),[n,o]=d.exports.useState(),[a,i]=d.exports.useState(!1);d.exports.useEffect(()=>{J().then(c=>r(c))},[]);function l(){n&&z(n).then(()=>{r(e.filter(c=>c!==n)),o(void 0)})}return s(h,{children:[t(p,{sx:{height:600,mt:3},children:t(O,{columns:U,rows:e,onSelectionModelChange:c=>o(e.find(C=>C.id===c[0]))})}),t(w,{selected:!!n,onDelete:l,setIsCreateDialogOpen:i,editable:!1})]})}const v={firstname:"",lastname:"",streetaddress:"",postcode:"",city:"",email:"",phone:""};function Z(e){const[r,n]=d.exports.useState(v);function o(){e.setIsDialogOpen(!1)}function a(i){i.preventDefault(),Object.values(r).every(l=>!!l)&&K(r).then(l=>{o(),e.setCustomers([...e.customers,l]),n(v)})}return s(D,{open:e.isDialogOpen,children:[t(x,{id:"alert-dialog-title",children:"Create new customer"}),t(b,{children:t(S,{id:"alert-dialog-description",children:s("form",{onSubmit:a,children:[t(u,{margin:"dense",label:"First name",value:r.firstname,onChange:i=>n({...r,firstname:i.target.value}),fullWidth:!0,required:!0}),t(u,{margin:"dense",label:"Last name",value:r.lastname,onChange:i=>n({...r,lastname:i.target.value}),fullWidth:!0,required:!0}),t(u,{margin:"dense",label:"Street address",value:r.streetaddress,onChange:i=>n({...r,streetaddress:i.target.value}),fullWidth:!0,required:!0}),t(u,{margin:"dense",label:"Post code",value:r.postcode,onChange:i=>n({...r,postcode:i.target.value}),fullWidth:!0,required:!0}),t(u,{margin:"dense",label:"City",value:r.city,onChange:i=>n({...r,city:i.target.value}),fullWidth:!0,required:!0}),t(u,{margin:"dense",label:"Email",value:r.email,onChange:i=>n({...r,email:i.target.value}),fullWidth:!0,required:!0}),t(u,{margin:"dense",label:"Phone",value:r.phone,onChange:i=>n({...r,phone:i.target.value}),fullWidth:!0,required:!0}),s(p,{sx:{mt:2},children:[t(f,{onClick:o,color:"primary",variant:"contained",sx:{float:"left"},children:"Cancel"}),t(f,{color:"success",variant:"contained",type:"submit",sx:{float:"right"},children:"Save"})]})]})})})]})}function ee(){const[e,r]=d.exports.useState([]),[n,o]=d.exports.useState(),[a,i]=d.exports.useState(!1);d.exports.useEffect(()=>{G().then(c=>r(c))},[]);function l(){n&&X(n).then(()=>{r([...e.filter(c=>c.id!==n.id)]),o(void 0)})}return s(h,{children:[t(p,{sx:{height:600,mt:3},children:t(O,{columns:Q,rows:e,onSelectionModelChange:c=>o(e.find(C=>C.id===c[0]))})}),t(Z,{isDialogOpen:a,setIsDialogOpen:i,customers:e,setCustomers:r}),t(w,{selected:!!n,onDelete:l,setIsCreateDialogOpen:i,editable:!0})]})}function te(){return s(M,{children:[s(m,{path:"/",element:t(Y,{}),children:[t(m,{path:"/customers",element:t(ee,{})}),t(m,{path:"/trainings",element:t(V,{})})]}),t(m,{path:"*",element:t("h1",{children:"Oops! Page not found..."})})]})}q.createRoot(document.getElementById("root")).render(t(L.StrictMode,{children:t(R,{basename:"/react-personal-trainer",children:t(te,{})})}));
